<?xml version="1.0" encoding="UTF-8"?>
<!--<beans xmlns="http://www.springframework.org/schema/beans"-->
<!--       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"-->
<!--       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">-->

<!--</beans>-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.e114.e114_eumyuratodemo1.jdbc.IDAO">
    <select id="viewSmallConcert" resultType="com.e114.e114_eumyuratodemo1.dto.SmallConcertDTO">
        SELECT *
            FROM small_concert

    </select>
    <select id="selectConcert" resultType="com.e114.e114_eumyuratodemo1.dto.SmallConcertDTO">
        SELECT *
        FROM small_concert
        WHERE id = #{param1}

    </select>
    <select id="selectConcertTime" resultType="com.e114.e114_eumyuratodemo1.dto.SchedulesDTO">
        SELECT *
        FROM schedules
        WHERE conId = #{param1} AND DATE_FORMAT(conDate, '%Y-%m-%d') = #{param2}

    </select>
    <select id="selectBooked" resultType="String">
        SELECT booked.seatNum
        FROM schedules
                 INNER JOIN booked
                            ON schedules.id = booked.sId
        WHERE schedules.conId = #{param1} AND DATE_FORMAT(schedules.conDate, '%Y-%m-%d') = #{param2}
    </select>
    <insert id="insertSeat" parameterType="java.util.Map">
        <foreach collection="seat" item="seatNum" separator=";">
            INSERT INTO booked (sId, seatNum)
            SELECT id, #{seatNum}
            FROM schedules
            WHERE conId = #{conId} AND DATE_FORMAT(schedules.conDate, '%Y-%m-%d') = #{conDate}
        </foreach>
    </insert>



</mapper>